# How to set up and experiment with Prometheus remote-write | Red Hat Developer (developers.redhat.com)

<https://developers.redhat.com/articles/2023/11/30/how-set-and-experiment-prometheus-remote-write#prometheus_remote_write>

## Description

This article demonstrates how to quickly set up an environment for experimenting with Prometheus remote-write.

## Content

[Skip to main content](#main-content){.visually-hidden .focusable .skip-link}

[![Redhat Developers Logo](/themes/custom/rhdp_fe/images/branding/2023_RHDLogo_reverse.svg){.pfe-navigation__logo-image}](/){.pfe-navigation__logo-link analytics-text="Logo" analytics-category="Logo" analytics-level="1"}

-   Products

    ### Featured

    -   [Red Hat Enterprise Linux](/products/rhel/overview){.view_mode_feature analytics-level="2" analytics-text="Red Hat Enterprise Linux" analytics-category="Products|Featured" drupal-link-system-path="products/rhel/overview"}
        ![Red Hat Enterprise Linux Icon](/sites/default/files/2023-10/RHEL-2.png "Red Hat Enterprise Linux"){loading="lazy" width="100" height="100" typeof="foaf:Image"}
        A secure, stable, and supported operating system.
    -   [Red Hat OpenShift](/products/openshift/overview){.view_mode_feature analytics-level="2" analytics-text="Red Hat OpenShift" analytics-category="Products|Featured" drupal-link-system-path="products/openshift/overview"}
        ![Openshift icon](/sites/default/files/Red%20Hat%20OS%402x.png "Openshift icon"){loading="lazy" width="201" height="201" typeof="foaf:Image"}
        A cloud-native application platform.
    -   [Red Hat Ansible Automation Platform](/products/ansible){.view_mode_feature analytics-level="2" analytics-text="Red Hat Ansible Automation Platform" analytics-category="Products|Featured" drupal-link-system-path="node/224071"}
        ![Ansible icon](/sites/default/files/ICO%20-%20Ansible%20Platform%20Learning%20Resources.png "Ansible icon"){loading="lazy" width="150" height="150" typeof="foaf:Image"}
        Simple IT automation anyone can use.
    -   [View All Red Hat Products](/products){analytics-linktype="cta" analytics-level="2" analytics-text="View All Red Hat Products" analytics-category="Products|Featured" drupal-link-system-path="node/204465"}

    ```{=html}
    <!-- -->
    ```
    -   ### Linux

        -   [Red Hat Enterprise Linux](/products/rhel/overview){.view_mode_default analytics-level="2" analytics-text="Red Hat Enterprise Linux" analytics-category="Products|Products center column|Column 1|Linux" drupal-link-system-path="products/rhel/overview"}
        -   [Red Hat Universal Base Images (UBI)](/products/rhel/ubi){.view_mode_default analytics-level="2" analytics-text="Red Hat Universal Base Images (UBI)" analytics-category="Products|Products center column|Column 1|Linux" drupal-link-system-path="node/210625"}
        -   [Red Hat Enterprise Linux for SAP](/products/rhel/overview#rhel-for-sap){.view_mode_default analytics-level="2" analytics-text="Red Hat Enterprise Linux for SAP" analytics-category="Products|Products center column|Column 1|Linux" drupal-link-system-path="products/rhel/overview"}
        -   [Microsoft SQL Server on Red Hat Enterprise Linux](/products/rhel/overview#sql-server-rhel){.view_mode_default analytics-level="2" analytics-text="Microsoft SQL Server on Red Hat Enterprise Linux" analytics-category="Products|Products center column|Column 1|Linux" drupal-link-system-path="products/rhel/overview"}
        -   [CentOS Linux](/products/rhel/centos-and-rhel){.view_mode_default analytics-level="2" analytics-text="CentOS Linux" analytics-category="Products|Products center column|Column 1|Linux" drupal-link-system-path="node/274191"}

    -   ### Java runtimes & frameworks

        -   [JBoss Enterprise Application Platform](/products/eap/overview){.view_mode_default analytics-level="2" analytics-text="JBoss Enterprise Application Platform" analytics-category="Products|Products center column|Column 1|Java runtimes & frameworks" drupal-link-system-path="products/eap/overview"}
        -   [Red Hat build of Quarkus](/products/quarkus){.view_mode_default analytics-level="2" analytics-text="Red Hat build of Quarkus" analytics-category="Products|Products center column|Column 1|Java runtimes & frameworks" drupal-link-system-path="node/219015"}
        -   [Red Hat build of OpenJDK](/products/openjdk/overview){.view_mode_default analytics-level="2" analytics-text="Red Hat build of OpenJDK" analytics-category="Products|Products center column|Column 1|Java runtimes & frameworks" drupal-link-system-path="products/openjdk/overview"}
        -   [View all](/java/runtimes-and-frameworks){analytics-linktype="cta" analytics-level="2" analytics-text="View all" analytics-category="Products|Products center column|Column 1|Java runtimes & frameworks" drupal-link-system-path="node/275541"}

    ```{=html}
    <!-- -->
    ```
    -   ### Kubernetes

        -   [Red Hat OpenShift](/products/openshift/overview){.view_mode_default analytics-level="2" analytics-text="Red Hat OpenShift" analytics-category="Products|Products center column|Column 2|Kubernetes" drupal-link-system-path="products/openshift/overview"}
        -   [Red Hat OpenShift Service on AWS (ROSA)](/products/red-hat-openshift-service-on-aws){.view_mode_default analytics-level="2" analytics-text="Red Hat OpenShift Service on AWS (ROSA)" analytics-category="Products|Products center column|Column 2|Kubernetes" drupal-link-system-path="node/283794"}
        -   [Microsoft Azure Red Hat OpenShift](/products/openshift/openshift-public-cloud){.view_mode_default analytics-level="2" analytics-text="Microsoft Azure Red Hat OpenShift" analytics-category="Products|Products center column|Column 2|Kubernetes" drupal-link-system-path="node/283406"}
        -   [Red Hat OpenShift Dedicated](/products/openshift/openshift-public-cloud){.view_mode_default analytics-level="2" analytics-text="Red Hat OpenShift Dedicated" analytics-category="Products|Products center column|Column 2|Kubernetes" drupal-link-system-path="node/283406"}
        -   [Red Hat OpenShift Data Science](/products/red-hat-openshift-data-science/overview){.view_mode_default analytics-level="2" analytics-text="Red Hat OpenShift Data Science" analytics-category="Products|Products center column|Column 2|Kubernetes" drupal-link-system-path="products/red-hat-openshift-data-science/overview"}

    -   ### Integration & App Connectivity

        -   [Red Hat Service Interconnect](/products/service-interconnect/overview){.view_mode_default analytics-level="2" analytics-text="Red Hat Service Interconnect" analytics-category="Products|Products center column|Column 2|Integration & App Connectivity" drupal-link-system-path="products/service-interconnect/overview"}
        -   [AMQ Broker](/products/integration/overview#amq-broker){.view_mode_default analytics-level="2" analytics-text="AMQ Broker" analytics-category="Products|Products center column|Column 2|Integration & App Connectivity" drupal-link-system-path="products/integration/overview"}
        -   [View all](/products/integration/overview){analytics-linktype="cta" analytics-level="2" analytics-text="View all" analytics-category="Products|Products center column|Column 2|Integration & App Connectivity" drupal-link-system-path="products/integration/overview"}

    ```{=html}
    <!-- -->
    ```
    -   ### Automation

        -   [Red Hat Ansible Automation Platform](/products/ansible/overview){.view_mode_default analytics-level="2" analytics-text="Red Hat Ansible Automation Platform" analytics-category="Products|Products center column|Column 3|Automation" drupal-link-system-path="products/ansible/overview"}
        -   [Red Hat Ansible Automation Platform via AWS Marketplace](/products/ansible/overview#ansible-on-public-clouds){.view_mode_default analytics-level="2" analytics-text="Red Hat Ansible Automation Platform via AWS Marketplace" analytics-category="Products|Products center column|Column 3|Automation" drupal-link-system-path="products/ansible/overview"}
        -   [Red Hat Ansible Lightspeed with IBM watsonx Code Assistant](/products/ansible/lightspeed){.view_mode_default analytics-level="2" analytics-text="Red Hat Ansible Lightspeed with IBM watsonx Code Assistant" analytics-category="Products|Products center column|Column 3|Automation" drupal-link-system-path="node/284283"}
        -   [Ansible automation for applications and services](/topics/ansible-automation-applications-and-services){.view_mode_default analytics-level="2" analytics-text="Ansible automation for applications and services" analytics-category="Products|Products center column|Column 3|Automation" drupal-link-system-path="node/283734"}
        -   [View all](/products/ansible/overview){analytics-linktype="cta" analytics-level="2" analytics-text="View all" analytics-category="Products|Products center column|Column 3|Automation" drupal-link-system-path="products/ansible/overview"}

    -   ### Developer tools

        -   [Red Hat Developer Hub](/rhdh){.view_mode_default analytics-level="2" analytics-text="Red Hat Developer Hub" analytics-category="Products|Products center column|Column 3|Developer tools" drupal-link-system-path="products/developer-hub/overview"}
        -   [Red Hat Trusted Software Supply Chain](/products/trusted-software-supply-chain/overview){.view_mode_default analytics-level="2" analytics-text="Red Hat Trusted Software Supply Chain" analytics-category="Products|Products center column|Column 3|Developer tools" drupal-link-system-path="products/trusted-software-supply-chain/overview"}
        -   [Red Hat OpenShift Dev Spaces](/products/openshift-dev-spaces/overview){.view_mode_default analytics-level="2" analytics-text="Red Hat OpenShift Dev Spaces" analytics-category="Products|Products center column|Column 3|Developer tools" drupal-link-system-path="products/openshift-dev-spaces/overview"}
        -   [View all](/topics/developer-tools){analytics-linktype="cta" analytics-level="2" analytics-text="View all" analytics-category="Products|Products center column|Column 3|Developer tools" drupal-link-system-path="node/206665"}

    ```{=html}
    <!-- -->
    ```
    -   ### Developer Sandbox for Red Hat OpenShift

        ![Developer Sandbox](/sites/default/files/homepage-sandbox.jpg "Sandbox"){loading="lazy" width="601" height="357" typeof="foaf:Image"}

        Try Red Hat products and technologies without setup or configuration fees for 30 days with this shared Openshift and Kubernetes cluster.

    -   [Try at no cost](/developer-sandbox){analytics-linktype="cta" analytics-level="2" analytics-text="Try at no cost" analytics-category="Products|Products Callout Column" drupal-link-system-path="node/267151"}

-   Technologies

    ### Featured

    -   [Linux](/topics/linux){.view_mode_feature analytics-level="2" analytics-text="Linux" analytics-category="Technologies|Featured" drupal-link-system-path="node/204685"}
        ![Linux Icon](/sites/default/files/Red%20Hat%20OS%20Platform%402x.png "Linux Icon"){loading="lazy" width="201" height="201" typeof="foaf:Image"}
    -   [Kubernetes](https://developers.redhat.com/topics/kubernetes){.view_mode_feature analytics-level="2" analytics-text="Kubernetes" analytics-category="Technologies|Featured"}
        ![Cloud icon](/sites/default/files/Cloud-native%20app%20server%20on%20OpenShift.png "Cloud icon"){loading="lazy" width="363" height="365" typeof="foaf:Image"}
    -   [Automation](/topics/automation){.view_mode_feature analytics-level="2" analytics-text="Automation" analytics-category="Technologies|Featured" drupal-link-system-path="node/268611"}
        ![Automation Icon showing arrows moving in a circle around a gear](/sites/default/files/2023-10/Automation-2.png "Automation"){loading="lazy" width="100" height="100" typeof="foaf:Image"}
    -   [App Dev Platform](/app-dev-platform){.view_mode_feature analytics-level="2" analytics-text="App Dev Platform" analytics-category="Technologies|Featured" drupal-link-system-path="node/280141"}
        ![App Dev Platform icon showing coding brackets](/sites/default/files/2023-10/App-Dev-Platform-2.png "App-Dev Platform"){loading="lazy" width="100" height="100" typeof="foaf:Image"}
    -   [View All Technologies](/topics){analytics-linktype="cta" analytics-level="2" analytics-text="View All Technologies" analytics-category="Technologies|Featured" drupal-link-system-path="node/283525"}

    ```{=html}
    <!-- -->
    ```
    -   ### Programming Languages & Frameworks

        -   [Java](/java){.view_mode_default analytics-level="2" analytics-text="Java" analytics-category="Technologies|Technologies Center Column|Column 1|Programming Languages & Frameworks" drupal-link-system-path="node/275481"}
        -   [Python](/topics/python){.view_mode_default analytics-level="2" analytics-text="Python" analytics-category="Technologies|Technologies Center Column|Column 1|Programming Languages & Frameworks" drupal-link-system-path="node/265291"}
        -   [C, C#, C++](/topics/c){.view_mode_default analytics-level="2" analytics-text="C, C#, C++" analytics-category="Technologies|Technologies Center Column|Column 1|Programming Languages & Frameworks" drupal-link-system-path="node/207225"}

    -   ### System Design & Architecture

        -   [Red Hat architecture and design patterns](/topics/red-hat-architecture-and-design-patterns){.view_mode_default analytics-level="2" analytics-text="Red Hat architecture and design patterns" analytics-category="Technologies|Technologies Center Column|Column 1|System Design & Architecture" drupal-link-system-path="node/283560"}
        -   [Microservices](/topics/microservices){.view_mode_default analytics-level="2" analytics-text="Microservices" analytics-category="Technologies|Technologies Center Column|Column 1|System Design & Architecture" drupal-link-system-path="node/204665"}
        -   [Event-Driven Architecture](/topics/event-driven){.view_mode_default analytics-level="2" analytics-text="Event-Driven Architecture" analytics-category="Technologies|Technologies Center Column|Column 1|System Design & Architecture" drupal-link-system-path="node/211965"}

    ```{=html}
    <!-- -->
    ```
    -   ### Developer Productivity

        -   [Developer Tools](https://developers.redhat.com/topics/developer-tools){.view_mode_default analytics-level="2" analytics-text="Developer Tools" analytics-category="Technologies|Technologies Center Column|Column 2|Developer Productivity"}
        -   [Visual Studio Code (VS Code)](/products/vscode-extensions/overview){.view_mode_default analytics-level="2" analytics-text="Visual Studio Code (VS Code)" analytics-category="Technologies|Technologies Center Column|Column 2|Developer Productivity" drupal-link-system-path="products/vscode_extensions/overview"}
        -   [GitOps](/topics/gitops){.view_mode_default analytics-level="2" analytics-text="GitOps" analytics-category="Technologies|Technologies Center Column|Column 2|Developer Productivity" drupal-link-system-path="node/226411"}

    -   ### Secure Development & Architectures

        -   [Security](/topics/security){.view_mode_default analytics-level="2" analytics-text="Security" analytics-category="Technologies|Technologies Center Column|Column 2|Secure Development & Architectures" drupal-link-system-path="node/206685"}
        -   [Secure coding](/topics/secure-coding){.view_mode_default analytics-level="2" analytics-text="Secure coding" analytics-category="Technologies|Technologies Center Column|Column 2|Secure Development & Architectures" drupal-link-system-path="node/204615"}

    ```{=html}
    <!-- -->
    ```
    -   ### Platform Engineering

        -   [DevOps](/topics/devops){.view_mode_default analytics-level="2" analytics-text="DevOps" analytics-category="Technologies|Technologies Center Column|Column 3|Platform Engineering" drupal-link-system-path="node/204635"}
        -   [DevSecOps](/topics/devsecops){.view_mode_default analytics-level="2" analytics-text="DevSecOps" analytics-category="Technologies|Technologies Center Column|Column 3|Platform Engineering" drupal-link-system-path="node/268031"}
        -   [Ansible automation for applications and services](/topics/ansible-automation-applications-and-services){.view_mode_default analytics-level="2" analytics-text="Ansible automation for applications and services" analytics-category="Technologies|Technologies Center Column|Column 3|Platform Engineering" drupal-link-system-path="node/283734"}

    -   ### Automated Data Processing

        -   [AI/ML](/topics/ai-ml){.view_mode_default analytics-level="2" analytics-text="AI/ML" analytics-category="Technologies|Technologies Center Column|Column 3|Automated Data Processing" drupal-link-system-path="node/222695"}
        -   [Data Science](/topics/data-science){.view_mode_default analytics-level="2" analytics-text="Data Science" analytics-category="Technologies|Technologies Center Column|Column 3|Automated Data Processing" drupal-link-system-path="node/265181"}
        -   [Apache Kafka on Kubernetes](/topics/kafka-kubernetes){.view_mode_default analytics-level="2" analytics-text="Apache Kafka on Kubernetes" analytics-category="Technologies|Technologies Center Column|Column 3|Automated Data Processing" drupal-link-system-path="node/221755"}
        -   [View All Technologies](/topics){analytics-linktype="cta" analytics-level="2" analytics-text="View All Technologies" analytics-category="Technologies|Technologies Center Column|Column 3|Automated Data Processing" drupal-link-system-path="node/283525"}

    ```{=html}
    <!-- -->
    ```
    -   ### Start exploring in the Developer Sandbox for free

        ![sandbox graphic](/sites/default/files/2023-10/2023_RHD_SandBox_Graphic_final.png "sandbox graphic"){loading="lazy" width="800" height="421" typeof="foaf:Image"}

        Try Red Hat\'s products and technologies without setup or configuration.

    -   [Try at no cost](/developer-sandbox){analytics-linktype="cta" analytics-level="2" analytics-text="Try at no cost" analytics-category="Technologies|Technologies Callout Column" drupal-link-system-path="node/267151"}

-   Learn

    ### Featured

    -   [Kubernetes & Cloud Native](/learn/openshift){.view_mode_feature analytics-level="2" analytics-text="Kubernetes & Cloud Native" analytics-category="Learn|Featured" drupal-link-system-path="node/264181"}
        ![Openshift icon](/sites/default/files/Red%20Hat%20OS%402x.png "Openshift icon"){loading="lazy" width="201" height="201" typeof="foaf:Image"}
    -   [Linux](/learn/rhel){.view_mode_feature analytics-level="2" analytics-text="Linux" analytics-category="Learn|Featured" drupal-link-system-path="node/284171"}
        ![Rhel icon](/sites/default/files/Red%20Hat%20OS%20Platform%402x.png "Rhel icon"){loading="lazy" width="201" height="201" typeof="foaf:Image"}
    -   [Automation](/learn/ansible){.view_mode_feature analytics-level="2" analytics-text="Automation" analytics-category="Learn|Featured" drupal-link-system-path="node/284291"}
        ![Ansible cloud icon](/sites/default/files/ICO%20-%20Download%20Ansible%20Automation%20Platform.png "Ansible cloud icon"){loading="lazy" width="124" height="124" typeof="foaf:Image"}
    -   [Java](/learn/java){.view_mode_feature analytics-level="2" analytics-text="Java" analytics-category="Learn|Featured" drupal-link-system-path="node/284164"}
        ![Java icon](/sites/default/files/2023-10/java.png "Java icon"){loading="lazy" width="100" height="100" typeof="foaf:Image"}
    -   [AI/ML](/learn/openshift-data-science){.view_mode_feature analytics-level="2" analytics-text="AI/ML" analytics-category="Learn|Featured" drupal-link-system-path="node/272351"}
        ![AI/ML Icon](/sites/default/files/2023-10/ai-ml.png "AI/ML Icon"){loading="lazy" width="100" height="100" typeof="foaf:Image"}
    -   [View All Learning Resources](/learn){analytics-linktype="cta" analytics-level="2" analytics-text="View All Learning Resources" analytics-category="Learn|Featured" drupal-link-system-path="node/263961"}

    ### Initeractive Lessons and Learning Paths

    -   [Red Hat Enterprise Linux](/learn/rhel){.view_mode_default analytics-level="2" analytics-text="Red Hat Enterprise Linux" analytics-category="Learn|Learn Center Column|Column 1|Initeractive Lessons and Learning Paths" drupal-link-system-path="node/284171"}
    -   [Red Hat OpenShift](/learn/openshift){.view_mode_default analytics-level="2" analytics-text="Red Hat OpenShift" analytics-category="Learn|Learn Center Column|Column 1|Initeractive Lessons and Learning Paths" drupal-link-system-path="node/264181"}
    -   [Red Hat Ansible Automation Platform](/learn/ansible){.view_mode_default analytics-level="2" analytics-text="Red Hat Ansible Automation Platform" analytics-category="Learn|Learn Center Column|Column 1|Initeractive Lessons and Learning Paths" drupal-link-system-path="node/284291"}
    -   [Red Hat OpenShift AI](/learn/openshift-data-science){.view_mode_default analytics-level="2" analytics-text="Red Hat OpenShift AI" analytics-category="Learn|Learn Center Column|Column 1|Initeractive Lessons and Learning Paths" drupal-link-system-path="node/272351"}
    -   [Java](/learn/java){.view_mode_default analytics-level="2" analytics-text="Java" analytics-category="Learn|Learn Center Column|Column 1|Initeractive Lessons and Learning Paths" drupal-link-system-path="node/284164"}

    ### Developer Sandbox Activities

    -   [Get Started](/developer-sandbox){.view_mode_default analytics-level="2" analytics-text="Get Started" analytics-category="Learn|Learn Center Column|Column 1|Developer Sandbox Activities" drupal-link-system-path="node/267151"}
    -   [Try Hands-On Activities](/developer-sandbox/activities "Try Hands-On Activities"){.view_mode_default analytics-level="2" analytics-text="Try Hands-On Activities" analytics-category="Learn|Learn Center Column|Column 1|Developer Sandbox Activities" drupal-link-system-path="node/226191"}

    ### E-Books

    -   [GitOps Cookbook](/e-books/gitops-cookbook){.view_mode_default analytics-level="2" analytics-text="GitOps Cookbook" analytics-category="Learn|Learn Center Column|Column 2|E-Books" drupal-link-system-path="node/275101"}
    -   [Podman in Action](/e-books/podman-action){.view_mode_default analytics-level="2" analytics-text="Podman in Action" analytics-category="Learn|Learn Center Column|Column 2|E-Books" drupal-link-system-path="node/279671"}
    -   [Kubernetes Operators](/e-books/kubernetes-operators){.view_mode_default analytics-level="2" analytics-text="Kubernetes Operators" analytics-category="Learn|Learn Center Column|Column 2|E-Books" drupal-link-system-path="node/218235"}
    -   [The Path to GitOps](https://developers.redhat.com/e-books/path-gitops){.view_mode_default analytics-level="2" analytics-text="The Path to GitOps" analytics-category="Learn|Learn Center Column|Column 2|E-Books"}
    -   [View All E-books](/e-books){analytics-linktype="cta" analytics-level="2" analytics-text="View All E-books" analytics-category="Learn|Learn Center Column|Column 2|E-Books" drupal-link-system-path="node/267101"}

    ### Tutorials

    -   [Kubernetes](/learn/kubernetes-tutorials){.view_mode_default analytics-level="2" analytics-text="Kubernetes" analytics-category="Learn|Learn Center Column|Column 2|Tutorials" drupal-link-system-path="node/284340"}
    -   [Application Development](/learn/application-development-tutorials){.view_mode_default analytics-level="2" analytics-text="Application Development" analytics-category="Learn|Learn Center Column|Column 2|Tutorials" drupal-link-system-path="node/284335"}

    ### Cheat Sheets

    -   [Linux Commands](/cheat-sheets/linux-commands-cheat-sheet-old){.view_mode_default analytics-level="2" analytics-text="Linux Commands" analytics-category="Learn|Learn Center Column|Column 3|Cheat Sheets" drupal-link-system-path="node/36995"}
    -   [Bash Commands](/cheat-sheets/bash-shell-cheat-sheet){.view_mode_default analytics-level="2" analytics-text="Bash Commands" analytics-category="Learn|Learn Center Column|Column 3|Cheat Sheets" drupal-link-system-path="node/265091"}
    -   [Git](/cheat-sheets/git-cheat-sheet){.view_mode_default analytics-level="2" analytics-text="Git" analytics-category="Learn|Learn Center Column|Column 3|Cheat Sheets" drupal-link-system-path="node/47155"}
    -   [systemd Commands](/cheat-sheets/systemd-commands-cheat-sheet){.view_mode_default analytics-level="2" analytics-text="systemd Commands" analytics-category="Learn|Learn Center Column|Column 3|Cheat Sheets" drupal-link-system-path="node/275171"}
    -   [View All Cheat Sheets](/cheat-sheets){analytics-linktype="cta" analytics-level="2" analytics-text="View All Cheat Sheets" analytics-category="Learn|Learn Center Column|Column 3|Cheat Sheets" drupal-link-system-path="node/267111"}

    ### API Catalog

    -   [API Catalog](/api-catalog/){.view_mode_default analytics-level="2" analytics-text="API Catalog" analytics-category="Learn|Learn Center Column|Column 3|API Catalog"}
    -   [Legacy Documentation](https://console.redhat.com/docs/api){.view_mode_default analytics-level="2" analytics-text="Legacy Documentation" analytics-category="Learn|Learn Center Column|Column 3|API Catalog"}

    ```{=html}
    <!-- -->
    ```
    -   ### Red Hat Learning

        ![Learning image](/sites/default/files/2023-10/learning.png "Learning image"){loading="lazy" width="1000" height="658" typeof="foaf:Image"}

        Boost your technical skills to expert-level with the help of interactive lessons offered by various Red Hat Learning programs.

    -   [Explore Red Hat Learning](/learn){analytics-linktype="cta" analytics-level="2" analytics-text="Explore Red Hat Learning" analytics-category="Learn|Learn Callout Column" drupal-link-system-path="node/263961"}

-   Events

    ### Developer Events

    -   [DevNation](/devnation){.view_mode_feature analytics-level="2" analytics-text="DevNation" analytics-category="Events|Developer Events" drupal-link-system-path="node/206785"}
        Join developers across the globe for live and virtual events led by Red Hat technology experts.
    -   [Explore All Events](/events){analytics-linktype="cta" analytics-level="2" analytics-text="Explore All Events" analytics-category="Events|Developer Events" drupal-link-system-path="node/276891"}

    ```{=html}
    <!-- -->
    ```
    -   ### Tech Talks

        -   [Getting Gitops](/devnation/tech-talks/getting-gitops){.view_mode_default analytics-level="2" analytics-text="Getting Gitops" analytics-category="Events|Events Center Column|Column 1|Tech Talks" drupal-link-system-path="node/283683"}
        -   [GitHub Makeover](/devnation/tech-talks/github-makeover){.view_mode_default analytics-level="2" analytics-text="GitHub Makeover" analytics-category="Events|Events Center Column|Column 1|Tech Talks" drupal-link-system-path="node/276911"}
        -   [OpenTelemetry on Kubernetes](/devnation/tech-talks/using-opentelemetry-on-kubernetes){.view_mode_default analytics-level="2" analytics-text="OpenTelemetry on Kubernetes" analytics-category="Events|Events Center Column|Column 1|Tech Talks" drupal-link-system-path="node/283620"}
        -   [View All Tech Talks](/devnation/tech-talks){analytics-linktype="cta" analytics-level="2" analytics-text="View All Tech Talks" analytics-category="Events|Events Center Column|Column 1|Tech Talks" drupal-link-system-path="node/217135"}

    ```{=html}
    <!-- -->
    ```
    -   ### Deep Dives

        -   [Quinoa: A modern Quarkus UI with no hassles](/devnation/tech-talks/quinoa-quarkus-ui){.view_mode_default analytics-level="2" analytics-text="Quinoa: A modern Quarkus UI with no hassles" analytics-category="Events|Events Center Column|Column 2|Deep Dives" drupal-link-system-path="node/275791"}
        -   [Event-driven autoscaling through KEDA and Knative Integration](/devnation/tech-talks/autoscaling-KEDA-knative){.view_mode_default analytics-level="2" analytics-text="Event-driven autoscaling through KEDA and Knative Integration" analytics-category="Events|Events Center Column|Column 2|Deep Dives" drupal-link-system-path="node/275191"}
        -   [View All Deep Dives](/devnation/deep-dive){analytics-linktype="cta" analytics-level="2" analytics-text="View All Deep Dives" analytics-category="Events|Events Center Column|Column 2|Deep Dives" drupal-link-system-path="node/217155"}

    ```{=html}
    <!-- -->
    ```
    -   ### Red Hat Summit

        ![Red Hat Summit](/sites/default/files/2023-10/summit-logo-red%20%281%29.png "Red Hat Summit"){loading="lazy" width="290" height="150" typeof="foaf:Image"}

        Explore the Red Hat Summit 2023 virtual content hub and uncover insights that can fuel your future. Get on-demand access to the keynotes, sessions, and technical presentations from Red Hat Summit 2023 that are most relevant to your career.

    -   [View the content hub](https://reg.experiences.redhat.com/flow/redhat/sum23/regVirtual/login?extIdCarryOver=true&intcmp=701f20000012k69AAA&sc_cid=701f2000001OH6pAAG){analytics-linktype="cta" analytics-level="2" analytics-text="View the content hub" analytics-category="Events|Events Call Out Column"}

-   Developer Sandbox

    ### [Developer Sandbox (free)](){.view_mode_column_with_title analytics-level="2" analytics-text="Developer Sandbox (free)" analytics-category="Developer Sandbox|Developer Sandbox (free)"}

    -   [Try hands-on activities in the Developer Sandbox](/developer-sandbox/activities){.view_mode_feature analytics-level="2" analytics-text="Try hands-on activities in the Developer Sandbox" analytics-category="Developer Sandbox|Developer Sandbox (free)" drupal-link-system-path="node/226191"}
        Access Red Hat's products and technologies without setup or configuration, and start developing quicker than ever before with our new, no-cost sandbox environments.
    -   [Explore the Developer Sandbox IDE](/developer-sandbox/ide){.view_mode_default analytics-level="2" analytics-text="Explore the Developer Sandbox IDE" analytics-category="Developer Sandbox|Developer Sandbox (free)" drupal-link-system-path="node/267161"}

    ### [Featured Developer Sandbox activities](){.view_mode_column_with_title analytics-level="2" analytics-text="Featured Developer Sandbox activities" analytics-category="Developer Sandbox|Featured Developer Sandbox activities"}

    -   [Deploy a Java application on Kubernetes in minutes](/developer-sandbox/activities/how-to-deploy-java-application-in-kubernetes){.view_mode_default analytics-level="2" analytics-text="Deploy a Java application on Kubernetes in minutes" analytics-category="Developer Sandbox|Featured Developer Sandbox activities" drupal-link-system-path="node/226201"}
    -   [Learn Kubernetes using the Developer Sandbox](/developer-sandbox/activities/learn-kubernetes-using-red-hat-developer-sandbox-openshift){.view_mode_default analytics-level="2" analytics-text="Learn Kubernetes using the Developer Sandbox" analytics-category="Developer Sandbox|Featured Developer Sandbox activities" drupal-link-system-path="node/263951"}
    -   [Deploy full-stack JavaScript apps to the Developer Sandbox](/developer-sandbox/activities/deploying-full-stack-javascript-applications-to-the-sandbox/part1){.view_mode_default analytics-level="2" analytics-text="Deploy full-stack JavaScript apps to the Developer Sandbox" analytics-category="Developer Sandbox|Featured Developer Sandbox activities" drupal-link-system-path="node/264211"}

    ### [Ready to start developing apps?](){.view_mode_column_with_title analytics-level="2" analytics-text="Ready to  start developing apps?" analytics-category="Developer Sandbox|Ready to  start developing apps?"}

    -   [Explore the free Developer Sandbox](/developer-sandbox){analytics-linktype="cta" analytics-level="2" analytics-text="Explore the free Developer Sandbox" analytics-category="Developer Sandbox|Ready to  start developing apps?" drupal-link-system-path="node/267151"}

-   [Blog](/blog){.pfe-navigation__menu-link .view_mode_default analytics-level="1" analytics-text="Blog" analytics-category="Blog" drupal-link-system-path="node/277891"}

Search

Search

All Red Hat

[]{#main-content tabindex="-1"}

Article

# How to set up and experiment with Prometheus remote-write {#developer-materials}

November 30, 2023

[]{.a2a_button_twitter aria-label="Share on twitter"}
[]{.a2a_button_facebook aria-label="Share on facebook"}
[]{.a2a_button_linkedin aria-label="Share on linkedin"}
[]{.a2a_button_email aria-label="Share with email"}

[Containers](/topics/containers){hreflang="en"}[Kubernetes](/topics/kubernetes){hreflang="en"}

[Yftach Herzog](/author/yftach-herzog)

Senior Software Engineer

![Kubernetes + OpenShift featured image](/sites/default/files/styles/article_feature/public/2020_OS_Shared_image_A_3.png?itok=2yaCalKR){loading="eager" srcset="/sites/default/files/styles/article_feature/public/2020_OS_Shared_image_A_3.png?itok=2yaCalKR 1x" width="960" height="480" typeof="foaf:Image"}

Table of contents:

Prometheus is widely used within monitoring and alerting stacks for [Red Hat OpenShift](https://developers.redhat.com/products/openshift/overview) and [Kubernetes](https://developers.redhat.com/topics/kubernetes) environments. It is an essential part of the OpenShift monitoring stack, and is also a part of the Cloud Native Computing Foundation (CNCF). One of its benefits is the ability to stack instances of Prometheus and other compatible tools (Grafana, Thanos, etc.) on top of one another in order to use metrics from monitored systems to perform tasks such as federating, filtering, aggregating, alerting and so on.

There are several ways to relay metrics between such instances---each has its pros and cons. But in this article, I'd specifically like to discuss a method called remote-write and provide a way to quickly set it up outside of the cluster in a local Podman environment. I've been looking for such an environment while trying to experiment with some remote-write configurations before deploying them to a cluster. I couldn't find good examples, so I came up with one.

But first, I will present a little background.

## What is Prometheus?

[Prometheus](https://prometheus.io/) is an open source monitoring software. It stores time series for **metrics**, where each metric is defined by a name and a unique set of arbitrary key-value pairs called **labels**. The only thing that changes for a given time series throughout the course of time is its **value**---a numeric value of a given [type](https://prometheus.io/docs/concepts/metric_types/).

Prometheus is collecting those metrics by pulling on HTTP endpoints that expose a plaintext page containing a list of metrics (each with name and labels) together with their current value.

For example, the snippet below is taken from a Prometheus instance's own `/metrics` endpoint that exposes its own metrics. Each line (excluding those starting with #) starts with a metric name, followed by zero or more labels and values (in curly braces), ending with a numeric value.

    # HELP go_gc_duration_seconds A summary of the pause duration of garbage collection cycles.
    # TYPE go_gc_duration_seconds summary
    go_gc_duration_seconds{quantile="0"} 2.7755e-05
    go_gc_duration_seconds{quantile="0.25"} 2.826e-05
    …
    go_gc_duration_seconds_sum 0.001053315
    go_gc_duration_seconds_count 7
    # HELP go_goroutines Number of goroutines that currently exist.
    # TYPE go_goroutines gauge
    go_goroutines 29
    # HELP net_conntrack_dialer_conn_failed_total Total number of connections failed to dial by the dialer a given name.
    # TYPE net_conntrack_dialer_conn_failed_total counter
    net_conntrack_dialer_conn_failed_total{dialer_name="alertmanager",reason="refused"} 0
    net_conntrack_dialer_conn_failed_total{dialer_name="alertmanager",reason="resolution"} 0
    net_conntrack_dialer_conn_failed_total{dialer_name="alertmanager",reason="timeout"} 0
    …

If a Prometheus instance will pull on (or scrape) this endpoint, it will create a time series in its database for each unique combination of metrics name and labels' names and values, and will periodically collect the metric value for each metric and add it to the respective time series.

## Prometheus remote-write

The example above suggests that Prometheus instances can be scraped by other Prometheus instances, but there are also several other ways to stack Prometheus and Prometheus-like instances. One such example is [federation](https://prometheus.io/docs/prometheus/latest/federation/), in which the Prometheus instance exposes yet another HTTP endpoint that can be scraped by other instances.

Here, we're going to discuss a push-based option called remote-write. The [remote-write protocol](https://prometheus.io/docs/concepts/remote_write_spec/) is intended to allow Prometheus instances to actively send the metrics they collect/receive to other instances.

Setup requires enabling remote-write sending and receiving on the relevant parties, configuring the sender with the receiver's target URL, setting up authentication, and deciding what information we want to send to the receiving end. This lab setup deals with configuring what to transmit.

## Lab setup

In my work, I was tasked with configuring remote-write from different Prometheus instances to a receiving endpoint that will centralize presentation and alerting for the metrics collected by those instances. As mentioned, there are some aspects for getting the connection working between the sender and the receiver, but one thing I was missing was the ability to convince myself in advance that once I get the connection going, I'm only going to send the information I intended to send and not something else (potentially flooding the target system with unwanted data).

For that purpose, I was looking for a quick way to test my configurations before having them deployed to a real environment---that\'s where the [remote-write mini lab](https://github.com/yftacherzog/prom-remote-write) comes in.

The lab requires Podman to be installed, but it can be used with Docker with some modifications. It contains Prometheus configurations adapted from [Prometheus' GitHub repository](https://github.com/prometheus/prometheus/blob/main/documentation/examples/prometheus.yml) for creating two Prometheus instances, a writer and a reader. It also contains the commands required for running those instances.

First, clone the GitHub repository:

    git clone git@github.com:yftacherzog/prom-remote-write.git

Run the reader:

    cd prom-remote-write
    podman run --rm \
        --privileged \
        -p 9090:9090 \
        -v./config/reader:/etc/prometheus \
        prom/prometheus \
        --config.file=/etc/prometheus/prometheus.yml \
        --web.enable-remote-write-receiver

Your terminal should now tail the Prometheus logs (let it tail for now):

    ts=2023-09-27T09:15:06.294Z caller=main.go:539 level=info msg="No time or size retention was set so using the default time retention" duration=15d
    …
    ts=2023-09-27T09:17:27.454Z caller=manager.go:1009 level=info component="rule manager" msg="Starting rule manager..."

On another terminal window, run the writer (note the ports difference, and the absence of remote-write-receiver flag):

    cd prom-remote-write
    podman run --rm \
        --privileged \
        -p 9070:9090 \
        -v./config/writer:/etc/prometheus \
        prom/prometheus \
        --config.file=/etc/prometheus/prometheus.yml

The logs should look similar to the reader except for the last line, which will indicate (after a few seconds) that remote-write is working:

    ts=2023-09-27T09:23:11.305Z caller=main.go:539 level=info msg="No time or size retention was set so using the default time retention" duration=15d
    …
    ts=2023-09-27T09:23:11.313Z caller=manager.go:1009 level=info component="rule manager" msg="Starting rule manager..."
    ts=2023-09-27T09:23:24.247Z caller=dedupe.go:112 component=remote level=info remote_name=931a9a url=http://host.containers.internal:9090/api/v1/write msg="Done replaying WAL" duration=12.934864615s

You should now be able to browse to both instances and see the Prometheus UI.

Reader: <http://localhost:9090/>

Writer: <http://localhost:9070/>

Now let's examine the [reader's configurations](https://github.com/yftacherzog/prom-remote-write/blob/main/config/reader/prometheus.yml):

    ...
    scrape_configs:
      # The job name is added as a label `job=<job_name>` to any timeseries scraped from this config.
      - job_name: "prometheus"

        # metrics_path defaults to '/metrics'
        # scheme defaults to 'http'.

        # static_configs:
        #   - targets: ["localhost:9090"]

The reader is not scraping anything. In fact, if you kill both instances (do it---press Ctrl+C on both terminals) and restart only the **reader**, you won't have any metrics available for presentation on that instance.

Browse to <http://localhost:9090/graph> and click the metrics explorer button (Figure 1).

<figure class="align-center rhd-u-has-filter-caption" role="group">
<figure class="media media--type-image media--view-mode-article-content rhd-c-figure">
<a href="/sites/default/files/1_10.png" data-featherlight="image"><img src="/sites/default/files/styles/article_floated/public/1_10.png?itok=YpbLXyU2" loading="lazy" typeof="foaf:Image" width="600" height="286" alt="A screenshot of the metrics explorer and the open metrics explorer button." /></a>
<figcaption>Figure 1: Open the Metrics Explorer by clicking the open metrics explorer button.</figcaption>
</figure>
<figcaption>Figure 1: Open the Metrics Explorer by clicking the open metrics explorer button.</figcaption>
</figure>

The Metrics Explorer should show no results (Figure 2).

<figure class="align-center" role="group">
<figure class="media media--type-image media--view-mode-article-content rhd-c-figure">
<a href="/sites/default/files/2_14.png" data-featherlight="image"><img src="/sites/default/files/styles/article_floated/public/2_14.png?itok=BeyucPQs" loading="lazy" typeof="foaf:Image" width="600" height="154" alt="The Metrics Explorer shows no results." /></a>
<figcaption>Figure 2: The Metrics Explorer is empty.</figcaption>
</figure>
</figure>

Both instances are generating metrics of their own (check out <http://localhost:9090/metrics>).

If we examine the [writer's configurations](https://github.com/yftacherzog/prom-remote-write/blob/main/config/writer/prometheus.yml), we'll see that the writer is scraping the metrics it generates:

    scrape_configs:
      # The job name is added as a label `job=<job_name>` to any timeseries scraped from this config.
      - job_name: "prometheus"

        # metrics_path defaults to '/metrics'
        # scheme defaults to 'http'.

        static_configs:
          - targets: ["localhost:9090"]

    remote_write:
      - url: "http://host.containers.internal:9090/api/v1/write"

        write_relabel_configs:
          # drop specific metrics from remote-write
        - source_labels: ['__name__']
          regex: 'go_gc_.*'
          action: 'drop'

          # keep only specific labels for the kept metrics
        - regex: '__name__|instance|job|version|branch'
          action: 'labelkeep'

It is also configured to remote-write to the reader. In a real environment, some authentication configurations will be required here, but for now we keep it very simple. Lastly, it contains some `write_relabel_configs`, which we'll discuss in a moment.

If you now restart the **writer** as well, in a few seconds, you could reload the **reader** page and see metrics on its metrics explorer (Figure 3). You could see almost the exact same picture on the writer as well in.

<figure class="align-center rhd-u-has-filter-caption" role="group">
<figure class="media media--type-image media--view-mode-article-content rhd-c-figure">
<a href="/sites/default/files/3_16.png" data-featherlight="image"><img src="/sites/default/files/styles/article_floated/public/3_16.png?itok=-00w7B9R" loading="lazy" typeof="foaf:Image" width="600" height="314" alt="The Metrics Explorer displays on the reader that it is no longer empty." /></a>
<figcaption>Figure 3: The Metrics Explorer displays writer's metrics on the reader.</figcaption>
</figure>
<figcaption>Figure 3: The readers Metrics Explorer displays writer's metrics.</figcaption>
</figure>

This means our connection works. Now we can experiment a bit.

We consult the Prometheus configurations reference -- specifically, the [remote-write section](https://prometheus.io/docs/prometheus/latest/configuration/configuration/#remote_write). There, we look at `write_relabel_configs`, which points us to generic [relabel configurations](https://prometheus.io/docs/prometheus/latest/configuration/configuration/#relabel_config) used for other purposes as well.

Relabeling allows us to decide which metrics and which labels we want to remote-write. I won't repeat what's explained there, but instead demonstrate how we use it in our setup.

`write_relabel_configs` is a list of actions applied in order. Each entry filters or modifies the set of metrics we send---both in terms of the identity of the metrics we send (the number of rows in the output) and in terms of the labels each metric has (the columns).

Our current configurations already contain a couple of actions:

        write_relabel_configs:
          # drop specific metrics from remote-write
        - source_labels: ['__name__']
          regex: 'go_gc_.*'
          action: 'drop'

          # keep only specific labels for the kept metrics
        - regex: '__name__|instance|job|version|branch'
          action: 'labelkeep'

The first action drops all metrics with names satisfying the mentioned regular expression. namely, any metric name that starts with `go_gc_`.

The second action drops all labels other than the ones on the regular expression (`__name__` is the internal label for the metric name).

Note that the first action affects the metric along with all its associated labels, while the second affects labels on any metric. In other words, the first action removes rows in the output, and the second action removes columns from metrics containing those labels.

If we check the **writer** at <http://localhost:9070/graph> and search for metrics conforming to the regex of the first action, we're going to see some results (Figure 4).

<figure class="align-center rhd-u-has-filter-caption" role="group">
<figure class="media media--type-image media--view-mode-article-content rhd-c-figure">
<a href="/sites/default/files/4_12.png" data-featherlight="image"><img src="/sites/default/files/styles/article_floated/public/4_12.png?itok=I7AQJoNX" loading="lazy" typeof="foaf:Image" width="600" height="355" alt="An example of metrics that exist on the writer but not on the reader." /></a>
<figcaption>Figure 4: An example of metrics that exist on the writer but not on the reader.</figcaption>
</figure>
<figcaption>Figure 4: go metrics available on the writer</figcaption>
</figure>

If we do the same for the **reader** at <http://localhost:9090/graph>, we should get nothing (Figure 5).

<figure class="align-center" role="group">
<figure class="media media--type-image media--view-mode-article-content rhd-c-figure">
<a href="/sites/default/files/5_11.png" data-featherlight="image"><img src="/sites/default/files/styles/article_floated/public/5_11.png?itok=dH8ZAPFT" loading="lazy" typeof="foaf:Image" width="600" height="197" alt="A screenshot of metrics displayed on the writer were filtered out of the reader." /></a>
<figcaption>Figure 5: Some metrics displayed on the writer were filtered out of the reader.</figcaption>
</figure>
</figure>

Next, let's do another example in which we add a label to every metric.

If we examine the `up` metric on the reader before the change, we see this in Figure 6:

<figure class="align-center rhd-u-has-filter-caption" role="group">
<figure class="media media--type-image media--view-mode-article-content rhd-c-figure">
<a href="/sites/default/files/6_5.png" data-featherlight="image"><img src="/sites/default/files/styles/article_floated/public/6_5.png?itok=bMWxJJuR" loading="lazy" typeof="foaf:Image" width="600" height="197" alt="A screenshot of the up metric before the changes." /></a>
<figcaption>Figure 6: The up metrics before the changes.</figcaption>
</figure>
<figcaption>Figure 6: The up metrics before the changes.</figcaption>
</figure>

We now add an action under the existing actions on the writer's configurations as follows:

    remote_write:
      - url: "http://host.containers.internal:9090/api/v1/write"

        write_relabel_configs:
          # drop specific metrics from remote-write
        - source_labels: ['__name__']
          regex: 'go_gc_.*'
          action: 'drop'

          # keep only specific labels for the kept metrics
        - regex: '__name__|instance|job|version|branch'
          action: 'labelkeep'

        - action: 'replace'
          target_label: 'source'
          replacement: 'writer-prometheus'

This adds a label called `source` with value `writer-prometheus` to every metric to be sent from the writer. After we save the file and restart the writer, we should see another label added to this (or any other) metric on the **reader** (Figure 7).

<figure class="align-center" role="group">
<figure class="media media--type-image media--view-mode-article-content rhd-c-figure">
<a href="/sites/default/files/7_5.png" data-featherlight="image"><img src="/sites/default/files/styles/article_floated/public/7_5.png?itok=jCFDAW0u" loading="lazy" typeof="foaf:Image" width="600" height="183" alt="The up metric contains additional label on the reader." /></a>
<figcaption>Figure 7: The up metric after changes contains additional label on the reader.</figcaption>
</figure>
</figure>

We can also confirm that the relabeling done under `remote-write`, only affects the receiving end, and not the metrics on the origin, as the same query on the writer will be left unchanged (Figure 8).

<figure class="align-center" role="group">
<figure class="media media--type-image media--view-mode-article-content rhd-c-figure">
<a href="/sites/default/files/8_3.png" data-featherlight="image"><img src="/sites/default/files/styles/article_floated/public/8_3.png?itok=o9VNkhG5" loading="lazy" typeof="foaf:Image" width="600" height="177" alt="The changes to the up metric did not affect the writer instance." /></a>
<figcaption>Figure 8: The up metric on the writer is unaffected.</figcaption>
</figure>
</figure>

Lastly, let's have an example in which we modify a selected label based on its value, and only for a specific metric:

    remote_write:
      - url: "http://host.containers.internal:9090/api/v1/write"

        write_relabel_configs:
          # drop specific metrics from remote-write
        - source_labels: ['__name__']
          regex: 'go_gc_.*'
          action: 'drop'

          # keep only specific labels for the kept metrics
        - regex: '__name__|instance|job|version|branch'
          action: 'labelkeep'

        - action: 'replace'
          target_label: 'source'
          replacement: 'writer-prometheus'

        - source_labels:
          - '__name__'
          - 'source'
          separator: ;
          regex: '(up);(writer-prometheus)'
          target_label: 'job'
          action: 'replace'
          replacement: '${2}-baz'

Let's go over the first three fields one by one.

`source_labels`: the labels according to which metrics will be selected for evaluation. `separator`: the separator used in the `regex` field to separate between the values of the different labels. `regex`: the regular expression according to which the metrics will be selected.

In this case, the combination of the fields above, means that this action is going to apply to metrics named `up` that have a source label with value `writer-prometheus`. The last part is redundant in this case, as all metrics have the same value for this label, but it's included here to demonstrate having more than a single regex match group.

Next fields are about the transformation to be made to the selected metrics:

`target_label`: the name of the label on the selected metrics to be affected. `action`: the action to apply on the target label (additional actions documented [here](https://prometheus.io/docs/prometheus/latest/configuration/configuration/#relabel_action)) `replacement`: the content to replace the target label with.

Here, the combination of these fields means that we will replace the `job` label on the selected metrics with the value of the second (`${2}`) regex match group (`writer-prometheus`) followed by the literal `-baz`.

If we now restart the writer, we can run a query on the reader to confirm that we only modified the selected metrics, and in the way that we intended (Figure 9).

<figure class="align-center" role="group">
<figure class="media media--type-image media--view-mode-article-content rhd-c-figure">
<a href="/sites/default/files/9_4.png" data-featherlight="image"><img src="/sites/default/files/styles/article_floated/public/9_4.png?itok=82uooFbZ" loading="lazy" typeof="foaf:Image" width="600" height="211" alt="The relabeling action affected only a specific metric." /></a>
<figcaption>Figure 9: The relabeling action affected only a specific metric.</figcaption>
</figure>
</figure>

The relabeling might not make perfect sense, but the idea behind it is to demonstrate how to use the suggested approach and to touch on a few aspects about relabeling.

## Summary

The idea behind this article was to give a very brief background for Prometheus and remote-write and to provide a simple procedure for experimenting with remote-write relabeling. There's a lot more to Prometheus and remote-write than we covered, but hopefully this can bridge a gap for someone as it did for me.

**Note**: The configurations used in this lab are direct [Prometheus configurations](https://prometheus.io/docs/prometheus/latest/configuration/configuration/).

In my daily job, I seldom configure Prometheus directly. Instead, we use different Prometheus Operators (e.g., [Prometheus Operator](https://github.com/prometheus-operator/prometheus-operator), [OpenShift Cluster Monitor Operator](https://github.com/openshift/cluster-monitoring-operator), [Observability Operator](https://github.com/rhobs/observability-operator)) that react upon Kubernetes Custom Resources (CRs) to create, configure and maintain Prometheus instances.

The configurations within such CRs result in creation of Prometheus configurations which slightly differ in syntax compared to the CR itself. Most notably, Prometheus configurations follow the snake_case, while the operators follow the camelCase. So, for example, to have `remote_write` configured in Prometheus, the Kubernetes CR will contain `remoteWrite` configurations, and `target_label` will similarly be replaced with `targetLabel`. This is something to keep in mind when using any configurations created using the lab and applying them to operators-maintained instances.

It is also possible that some configurations supported in Prometheus are not supported by the operator you're using, so this is another aspect to keep in mind, although I did not run into such issues with configurations related to remote-write.

## Recent Articles

-   ### [Introduction to the Node.js reference architecture: Wrapping up](/articles/2024/01/03/introduction-nodejs-reference-architecture-wrapping){hreflang="en"} {#introduction-to-the-node.js-reference-architecture-wrapping-up .field-content .rhd-c-card__title}

-   ### [Exploring x86-64-v3 for Red Hat Enterprise Linux 10](/articles/2024/01/02/exploring-x86-64-v3-red-hat-enterprise-linux-10){hreflang="en"} {#exploring-x86-64-v3-for-red-hat-enterprise-linux-10 .field-content .rhd-c-card__title}

-   ### [How lazy debuginfo loading improves GDB and Valgrind](/articles/2024/01/02/how-lazy-debuginfo-loading-improves-gdb-and-valgrind){hreflang="en"} {#how-lazy-debuginfo-loading-improves-gdb-and-valgrind .field-content .rhd-c-card__title}

-   ### [Autoscaling Kafka workloads with custom metrics autoscaler](/articles/2023/12/29/autoscaling-kafka-workloads-custom-metrics-autoscaler){hreflang="en"} {#autoscaling-kafka-workloads-with-custom-metrics-autoscaler .field-content .rhd-c-card__title}

-   ### [Operating OpenShift the SRE way](/articles/2023/12/28/operating-openshift-sre-way){hreflang="en"} {#operating-openshift-the-sre-way .field-content .rhd-c-card__title}

## Related Content {#related-content .pf-c-title}

### [Monitoring container vitality and availability with Podman](/blog/2019/04/18/monitoring-container-vitality-and-availability-with-podman) {#monitoring-container-vitality-and-availability-with-podman .rhd-c-card__title}

### [How to configure OpenShift application monitoring and alerts](/articles/2023/10/03/how-configure-openshift-application-monitoring-and-alerts) {#how-to-configure-openshift-application-monitoring-and-alerts .rhd-c-card__title}

### [Monitor Node.js applications on Red Hat OpenShift with Prometheus](/blog/2021/03/22/monitor-node-js-applications-on-red-hat-openshift-with-prometheus) {#monitor-node.js-applications-on-red-hat-openshift-with-prometheus .rhd-c-card__title}

### [How to monitor an Eclipse MicroProfile 1.2 server with Prometheus](/blog/2017/10/25/monitor-eclipse-microprofile-1-2-server-prometheus) {#how-to-monitor-an-eclipse-microprofile-1.2-server-with-prometheus .rhd-c-card__title}

### [Domain-specific Prometheus metrics with Red Hat Process Automation Manager and Decision Manager](/blog/2019/10/31/domain-specific-prometheus-metrics-with-red-hat-process-automation-manager-and-decision-manager) {#domain-specific-prometheus-metrics-with-red-hat-process-automation-manager-and-decision-manager .rhd-c-card__title}

### [How to monitor workloads using OpenShift monitoring stack](/articles/2023/08/08/how-monitor-workloads-using-openshift-monitoring-stack) {#how-to-monitor-workloads-using-openshift-monitoring-stack .rhd-c-card__title}

##  What's up next? {#whats-up-next .pf-c-title}

<figure class="media media--type-image media--view-mode-article-content rhd-c-figure">
<a href="/sites/default/files/2023_GitOps_Cookbook_Tilecards_0.png" data-featherlight="image"><img src="/sites/default/files/styles/article_floated/public/2023_GitOps_Cookbook_Tilecards_0.png?itok=X-6TMvor" loading="lazy" typeof="foaf:Image" width="600" height="300" alt="Gitops Cookbook e-book tile card" /></a>
</figure>

GitOps has become a standard in deploying applications to Kubernetes, and many companies are adopting the methodology for their DevOps and cloud-native strategy. Download the **GitOps Cookbook** for useful recipes and examples for successful hands-on applications development and deployment with GitOps.

[Get the e-book
](https://developers.redhat.com/e-books/gitops-cookbook){.pf-c-button .pf-m-link .pf-u-pl-0 analytics-linktype="cta" analytics-text="Get the e-book" analytics-category="What's up next?"}

[](#top){#scroll-to-top}

[![Red Hat Developers logo](/themes/custom/rhdp_fe/images/branding/2023_RHDLogo_reverse.svg){loading="lazy"}](/){slot="logo" analytics-category="Footer" analytics-text="Logo"}
[LinkedIn](https://www.linkedin.com/showcase/red-hat-developer){analytics-region="social-links-exit" analytics-category="Footer|social-links" analytics-text="LinkedIn"}
[YouTube](https://www.youtube.com/channel/UC7noUdfWp-ukXUlAsJnSm-Q){analytics-region="social-links-exit" analytics-category="Footer|social-links" analytics-text="YouTube"}
[Twitter](https://twitter.com/rhdevelopers){analytics-region="social-links-exit" analytics-category="Footer|social-links" analytics-text="Twitter"}
[Facebook](https://www.facebook.com/redhatinc){analytics-region="social-links-exit" analytics-category="Footer|social-links" analytics-text="Facebook"}

### Products {#products slot="links" analytics-text="Products"}

-   [Red Hat Enterprise Linux](https://developers.redhat.com/products/rhel/overview){analytics-category="Footer|Products" analytics-text="Red Hat Enterprise Linux"}
-   [Red Hat OpenShift](https://developers.redhat.com/products/openshift/overview){analytics-category="Footer|Products" analytics-text="Red Hat OpenShift"}
-   [Red Hat Ansible Automation Platform](https://developers.redhat.com/products/ansible/overview){analytics-category="Footer|Products" analytics-text="Red Hat Ansible Automation Platform"}
-   [See all products](/products){analytics-category="Footer|Products" analytics-text="See all products"}
-   [See all technologies](/topics){analytics-category="Footer|Products" analytics-text="See all technologies"}

### Build {#build slot="links" analytics-text="Build"}

-   [Developer Sandbox](https://developers.redhat.com/developer-sandbox){analytics-category="Footer|Build" analytics-text="Developer Sandbox"}
-   [Developer Tools](/topics/developer-tools){analytics-category="Footer|Build" analytics-text="Developer Tools"}
-   [Interactive Tutorials](https://developers.redhat.com/learn#assembly-id-70181){analytics-category="Footer|Build" analytics-text="Interactive Tutorials"}
-   [API Catalog](https://developers.redhat.com/api-catalog/){analytics-category="Footer|Build" analytics-text="API Catalog"}
-   [Operators Marketplace](https://marketplace.redhat.com/en-us){analytics-category="Footer|Build" analytics-text="Operators Marketplace"}

### Quicklinks {#quicklinks slot="links" analytics-text="Quicklinks"}

-   [Learning Resources](/learn){analytics-category="Footer|Quicklinks" analytics-text="Learning Resources"}
-   [E-books](/e-books){analytics-category="Footer|Quicklinks" analytics-text="E-books"}
-   [Cheat Sheets](/cheat-sheets){analytics-category="Footer|Quicklinks" analytics-text="Cheat Sheets"}
-   [Blog](/blog){analytics-category="Footer|Quicklinks" analytics-text="Blog"}
-   [Events](/events){analytics-category="Footer|Quicklinks" analytics-text="Events"}

### Communicate {#communicate slot="links" analytics-text="Communicate"}

-   [About us](https://developers.redhat.com/about){analytics-category="Footer|Communicate" analytics-text="About us"}
-   [Contact sales](https://developers.redhat.com/contact-sales){analytics-category="Footer|Communicate" analytics-text="Contact sales"}
-   [Find a partner](https://catalog.redhat.com/partners/){analytics-category="Footer|Communicate" analytics-text="Find a partner"}
-   [Site Status Dashboard](https://status.redhat.com/){analytics-category="Footer|Communicate" analytics-text="Site Status Dashboard"}
-   [Report a security problem](https://access.redhat.com/security/team/contact/?extIdCarryOver=true&sc_cid=701f2000001OH6pAAG){analytics-category="Footer|Communicate" analytics-text="Report a security problem"}

### RED HAT DEVELOPER {#about-red-hat-developer slot="header" analytics-text="About Red Hat Developer"}

Build here. Go anywhere.

We serve the builders. The problem solvers who create careers with code.

Join us if you're a developer, software engineer, web designer, front-end designer, UX designer, computer scientist, architect, tester, product manager, project manager or team lead.

[Sign me up ![](data:image/svg+xml;base64,PHN2ZyBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyBmb250LXNpemU6IGluaGVyaXQ7IGhlaWdodDogMWVtOyBvdmVyZmxvdzogdmlzaWJsZTsgdmVydGljYWwtYWxpZ246IC0uMTI1ZW07IHdpZHRoOiAuODc1ZW07IiBjbGFzcz0ic3ZnLWlubGluZS0tZmEgZmEtYXJyb3ctcmlnaHQgZmEtdy0xNCIgYXJpYS1oaWRkZW49InRydWUiIGZvY3VzYWJsZT0iZmFsc2UiIGRhdGEtcHJlZml4PSJmYXMiIGRhdGEtaWNvbj0iYXJyb3ctcmlnaHQiIHJvbGU9ImltZyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB2aWV3Ym94PSIwIDAgNDQ4IDUxMiIgZGF0YS1mYS1pMnN2Zz48cGF0aCBmaWxsPSJjdXJyZW50Q29sb3IiIGQ9Ik0xOTAuNSA2Ni45bDIyLjItMjIuMmM5LjQtOS40IDI0LjYtOS40IDMzLjkgMEw0NDEgMjM5YzkuNCA5LjQgOS40IDI0LjYgMCAzMy45TDI0Ni42IDQ2Ny4zYy05LjQgOS40LTI0LjYgOS40LTMzLjkgMGwtMjIuMi0yMi4yYy05LjUtOS41LTkuMy0yNSAuNC0zNC4zTDMxMS40IDI5NkgyNGMtMTMuMyAwLTI0LTEwLjctMjQtMjR2LTMyYzAtMTMuMyAxMC43LTI0IDI0LTI0aDI4Ny40TDE5MC45IDEwMS4yYy05LjgtOS4zLTEwLTI0LjgtLjQtMzQuM3oiPjwvcGF0aD48L3N2Zz4=){.svg-inline--fa .fa-arrow-right .fa-w-14}](/register "Create a Red Hat Developer account"){.rhd-c-footer-sidebar-signup .pf-m-link-white}

We've updated our Privacy Statement effective July 1, 2023

### Red Hat legal and privacy links {#red-hat-legal-and-privacy-links slot="links-primary" hidden="" analytics-text="Red Hat legal and privacy links"}

-   [About Red Hat](https://redhat.com/en/about/company){analytics-category="Footer|Corporate" analytics-text="About Red Hat"}
-   [Jobs](https://redhat.com/en/jobs){analytics-category="Footer|Corporate" analytics-text="Jobs"}
-   [Events](https://redhat.com/en/events){analytics-category="Footer|Corporate" analytics-text="Events"}
-   [Locations](https://redhat.com/en/about/office-locations){analytics-category="Footer|Corporate" analytics-text="Locations"}
-   [Contact Red Hat](https://redhat.com/en/contact){analytics-category="Footer|Corporate" analytics-text="Contact Red Hat"}
-   [Red Hat Blog](https://redhat.com/en/blog){analytics-category="Footer|Corporate" analytics-text="Red Hat Blog"}
-   [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion/statement){analytics-category="Footer|Corporate" analytics-text="Diversity equity and inclusion"}
-   [Cool Stuff Store](https://coolstuff.redhat.com/){analytics-category="Footer|Corporate" analytics-text="Cool Stuff Store"}
-   [Red Hat Summit](https://www.redhat.com/en/summit){analytics-category="Footer|Corporate" analytics-text="Red Hat Summit"}

### Red Hat legal and privacy links {#red-hat-legal-and-privacy-links-1 slot="links-secondary" hidden="" analytics-text="Red Hat legal and privacy links"}

-   [Privacy statement](https://redhat.com/en/about/privacy-policy){analytics-category="Footer|Red Hat legal and privacy links" analytics-text="Privacy statement"}
-   [Terms of use](https://redhat.com/en/about/terms-use){analytics-category="Footer|Red Hat legal and privacy links" analytics-text="Terms of use"}
-   [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines){analytics-category="Footer|Red Hat legal and privacy links" analytics-text="All policies and guidelines"}
-   [Digital accessibility](https://redhat.com/en/about/digital-accessibility){analytics-category="Footer|Red Hat legal and privacy links" analytics-text="Digital accessibility"}
